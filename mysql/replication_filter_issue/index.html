<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>MySQL replication filter 사용 시 주의사항 | kimDuBiA</title><meta name=keywords content="mysql,replication,운영"><meta name=description content="MySQL replication_do_db 사용시 주의사항 하나의 DB서버에 여러 논리DB들이 있고 그 중 특정 논리DB를 다른 DB서버로 분리하는 작업을 종종 합니다.
이때 무중단으로 분리하기 위해서 replication filter 기능을 사용하는데요
이 때의 주의사항을 알아보도록 하겠습니다.
Replication filter 개요  리플리케이션 필터는 MySQL 복제 구성 시에 DB인스턴스 전체를 복제하는 것이 아닌 특정 논리DB만 복제해야할 때 사용할 수 있는 기능 옵션의 종류는 아래와 같이 존재  REPLICATE_DO_DB – 특정디비만 REPLICATE_IGNORE_DB – 특정디비제외 REPLICATE_DO_TABLE – 특정테이블만 REPLICATE_IGNORE_TABLE – 특정테이블 제외 REPLICATE_WILD_DO_TABLE – 특정패턴테이블만 REPLICATE_WILD_IGNORE_TABLE – 특정패턴테이블 제외 REPLICATE_REWRITE_DB – DB명 바꿔서   CHANGE REPLICATION FILTER 구문 사용시 동일종류 필터는 마지막 수행된 쿼리만 사용됨 ex)  change replication filter replicate_do_db=(kimdubi_db),replicate_do_db=(kimdubi_db2,kimdubi_db3); => kimdubi_db2, kimdubi_db3 만 replication 하도록 반영됨"><meta name=author content="kimdubi"><link rel=canonical href=/mysql/replication_filter_issue/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.2dbef8664bbfb3e83a0a44fd4a8fc5010240dbcd1dbc1400753b928b497b8f5e.css integrity="sha256-Lb74Zku/s+g6CkT9So/FAQJA280dvBQAdTuSi0l7j14=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-123-45','auto');ga('send','pageview');}</script><meta property="og:title" content="MySQL replication filter 사용 시 주의사항"><meta property="og:description" content="MySQL replication_do_db 사용시 주의사항 하나의 DB서버에 여러 논리DB들이 있고 그 중 특정 논리DB를 다른 DB서버로 분리하는 작업을 종종 합니다.
이때 무중단으로 분리하기 위해서 replication filter 기능을 사용하는데요
이 때의 주의사항을 알아보도록 하겠습니다.
Replication filter 개요  리플리케이션 필터는 MySQL 복제 구성 시에 DB인스턴스 전체를 복제하는 것이 아닌 특정 논리DB만 복제해야할 때 사용할 수 있는 기능 옵션의 종류는 아래와 같이 존재  REPLICATE_DO_DB – 특정디비만 REPLICATE_IGNORE_DB – 특정디비제외 REPLICATE_DO_TABLE – 특정테이블만 REPLICATE_IGNORE_TABLE – 특정테이블 제외 REPLICATE_WILD_DO_TABLE – 특정패턴테이블만 REPLICATE_WILD_IGNORE_TABLE – 특정패턴테이블 제외 REPLICATE_REWRITE_DB – DB명 바꿔서   CHANGE REPLICATION FILTER 구문 사용시 동일종류 필터는 마지막 수행된 쿼리만 사용됨 ex)  change replication filter replicate_do_db=(kimdubi_db),replicate_do_db=(kimdubi_db2,kimdubi_db3); => kimdubi_db2, kimdubi_db3 만 replication 하도록 반영됨"><meta property="og:type" content="article"><meta property="og:url" content="/mysql/replication_filter_issue/"><meta property="og:image" content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="mysql"><meta property="article:published_time" content="2021-10-04T21:49:23+09:00"><meta property="article:modified_time" content="2021-10-04T21:49:23+09:00"><meta property="og:site_name" content="kimDuBiA"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="MySQL replication filter 사용 시 주의사항"><meta name=twitter:description content="MySQL replication_do_db 사용시 주의사항 하나의 DB서버에 여러 논리DB들이 있고 그 중 특정 논리DB를 다른 DB서버로 분리하는 작업을 종종 합니다.
이때 무중단으로 분리하기 위해서 replication filter 기능을 사용하는데요
이 때의 주의사항을 알아보도록 하겠습니다.
Replication filter 개요  리플리케이션 필터는 MySQL 복제 구성 시에 DB인스턴스 전체를 복제하는 것이 아닌 특정 논리DB만 복제해야할 때 사용할 수 있는 기능 옵션의 종류는 아래와 같이 존재  REPLICATE_DO_DB – 특정디비만 REPLICATE_IGNORE_DB – 특정디비제외 REPLICATE_DO_TABLE – 특정테이블만 REPLICATE_IGNORE_TABLE – 특정테이블 제외 REPLICATE_WILD_DO_TABLE – 특정패턴테이블만 REPLICATE_WILD_IGNORE_TABLE – 특정패턴테이블 제외 REPLICATE_REWRITE_DB – DB명 바꿔서   CHANGE REPLICATION FILTER 구문 사용시 동일종류 필터는 마지막 수행된 쿼리만 사용됨 ex)  change replication filter replicate_do_db=(kimdubi_db),replicate_do_db=(kimdubi_db2,kimdubi_db3); => kimdubi_db2, kimdubi_db3 만 replication 하도록 반영됨"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Mysqls","item":"/mysql/"},{"@type":"ListItem","position":3,"name":"MySQL replication filter 사용 시 주의사항","item":"/mysql/replication_filter_issue/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"MySQL replication filter 사용 시 주의사항","name":"MySQL replication filter 사용 시 주의사항","description":"MySQL replication_do_db 사용시 주의사항 하나의 DB서버에 여러 논리DB들이 있고 그 중 특정 논리DB를 다른 DB서버로 분리하는 작업을 종종 합니다.\n이때 무중단으로 분리하기 위해서 replication filter 기능을 사용하는데요\n이 때의 주의사항을 알아보도록 하겠습니다.\nReplication filter 개요  리플리케이션 필터는 MySQL 복제 구성 시에 DB인스턴스 전체를 복제하는 것이 아닌 특정 논리DB만 복제해야할 때 사용할 수 있는 기능 옵션의 종류는 아래와 같이 존재  REPLICATE_DO_DB – 특정디비만 REPLICATE_IGNORE_DB – 특정디비제외 REPLICATE_DO_TABLE – 특정테이블만 REPLICATE_IGNORE_TABLE – 특정테이블 제외 REPLICATE_WILD_DO_TABLE – 특정패턴테이블만 REPLICATE_WILD_IGNORE_TABLE – 특정패턴테이블 제외 REPLICATE_REWRITE_DB – DB명 바꿔서   CHANGE REPLICATION FILTER 구문 사용시 동일종류 필터는 마지막 수행된 쿼리만 사용됨 ex)  change replication filter replicate_do_db=(kimdubi_db),replicate_do_db=(kimdubi_db2,kimdubi_db3); =\u0026gt; kimdubi_db2, kimdubi_db3 만 replication 하도록 반영됨","keywords":["mysql","replication","운영"],"articleBody":"MySQL replication_do_db 사용시 주의사항 하나의 DB서버에 여러 논리DB들이 있고 그 중 특정 논리DB를 다른 DB서버로 분리하는 작업을 종종 합니다.\n이때 무중단으로 분리하기 위해서 replication filter 기능을 사용하는데요\n이 때의 주의사항을 알아보도록 하겠습니다.\nReplication filter 개요  리플리케이션 필터는 MySQL 복제 구성 시에 DB인스턴스 전체를 복제하는 것이 아닌 특정 논리DB만 복제해야할 때 사용할 수 있는 기능 옵션의 종류는 아래와 같이 존재  REPLICATE_DO_DB – 특정디비만 REPLICATE_IGNORE_DB – 특정디비제외 REPLICATE_DO_TABLE – 특정테이블만 REPLICATE_IGNORE_TABLE – 특정테이블 제외 REPLICATE_WILD_DO_TABLE – 특정패턴테이블만 REPLICATE_WILD_IGNORE_TABLE – 특정패턴테이블 제외 REPLICATE_REWRITE_DB – DB명 바꿔서   CHANGE REPLICATION FILTER 구문 사용시 동일종류 필터는 마지막 수행된 쿼리만 사용됨 ex)  change replication filter replicate_do_db=(kimdubi_db),replicate_do_db=(kimdubi_db2,kimdubi_db3); = kimdubi_db2, kimdubi_db3 만 replication 하도록 반영됨\nREPLICATE_DO_DB 참고링크  https://dev.mysql.com/doc/refman/5.7/en/change-replication-filter.html https://dev.mysql.com/doc/refman/5.7/en/replication-options-replica.html#option_mysqld_replicate-do-db  주의사항  binlog_format=statement / mixed 일때 cross database query 복제안됨 default database 를 선언하지 않고 db명.테이블명 형태로 쿼리하는 경우도 복제 안됨  --replicate-do-db=sales USE prices; UPDATE sales.january SET amount=amount+1000; = prices DB에 접속 후 sales.테이블을 찾는 경우 Slave에 반영 안됨\ndefault database 를 선언하지 않고 db명.테이블명 형태로 쿼리하는 경우도 복제 안됨\n user 생성 복제 실패  ### SLAVE 복제 정보 replication_do_db=kimdubi_db,mysql,information_schema mysql show slave status\\G; *************************** 1. row *************************** Slave_IO_State: Waiting for master to send event Master_Log_File: mysql-bin.000162 Read_Master_Log_Pos: 484079558 Relay_Log_File: relay-bin.000005 Relay_Log_Pos: 892 Relay_Master_Log_File: mysql-bin.000162 Slave_IO_Running: Yes Slave_SQL_Running: Yes Replicate_Do_DB: kimdubi_db,mysql,information_schema ### Master user 생성 mysql create user 'test2'@'%' identified with mysql_native_password by 'test123'; Query OK, 0 rows affected (0.00 sec) ### Slave user 조회 mysql select user,host from mysql.user where user='test2'; Empty set (0.00 sec)  filter 외 다른 DB에서 수행한 DDL에 의해 복제 깨지는 케이스  # replication filter 적용된 DB에서 다른 논리DB의 오브젝트에 DDL을 수행하는경우 ### master mysql create table testdb2.tb_filter (a int auto_increment, b varchar(10), c datetime, primary key (a)); Query OK, 0 rows affected (0.09 sec) mysql use testdb2; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql drop table testdb2.tb_filter; Query OK, 0 rows affected (0.23 sec) ### SLAVE 복제 깨짐 mysql show slave status\\G; *************************** 1. row *************************** Slave_IO_State: Waiting for master to send event Master_Log_File: mysql-bin.000162 Read_Master_Log_Pos: 484079558 Relay_Log_File: relay-bin.000005 Relay_Log_Pos: 892 Relay_Master_Log_File: mysql-bin.000162 Slave_IO_Running: Yes Slave_SQL_Running: Yes Replicate_Do_DB: kimdubi_db,mysql,information_schema Last_Errno: 1051 Last_Error: Error 'Unknown table 'testdb2.tb_filter'' on query. Default database: 'kimdubi_db'. Query: 'DROP TABLE `testdb2`.`tb_filter` /* generated by server */' Skip_Counter: 0 binlog_format 개요  참고링크 : https://dev.mysql.com/doc/refman/5.7/en/binary-log-setting.html 종류  statement / 데이터 변경에 사용된 쿼리를 그대로 슬레이브에 전달하는 형태 row / 데이터 변경이 일어난 row의 정보를 어플리케이션에서 인지하는 포멧으로 슬레이브에 전달하는 형태 mixed / 위 두 방식을 혼합한 방식으로 대부분 statement로 진행하고, 일부 row방식으로 동작  (limit, now() 등 수행하는 서버,시점에 따라 결과 값이 달라질 수 있는 쿼리들에 대해선 row로 동작)     특징  동적으로 변경가능 global / session 변경 가능 쿼리 수행에는 영향이 없고 복제에만 영향 줌    해결방안  binlog_format 을 ROW로 사용한다  이 방법은 DB서버를 재기동해야 하기 때문에 개발팀과의 협의가 필요함 (set session binlog_format=row 로는 한계가 있음) binlog 저장량이 급증하는 이슈가 있음   어플리케이션의 JDBC 설정에 접근하는 논리DB에 대한 설정이 정확히 설정됐는지 확인 서로 다른 논리DB 간 cross database query 가 없는지 확인할 것  ","wordCount":"492","inLanguage":"en","datePublished":"2021-10-04T21:49:23+09:00","dateModified":"2021-10-04T21:49:23+09:00","author":{"@type":"Person","name":"kimdubi"},"mainEntityOfPage":{"@type":"WebPage","@id":"/mysql/replication_filter_issue/"},"publisher":{"@type":"Organization","name":"kimDuBiA","logo":{"@type":"ImageObject","url":"%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=/ title=Home><span>Home</span></a></li><li><a href=/categories/ title=categories><span>categories</span></a></li><li><a href=/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href>Home</a>&nbsp;»&nbsp;<a href=/mysql/>Mysqls</a></div><h1 class=post-title>MySQL replication filter 사용 시 주의사항</h1><div class=post-meta>October 4, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;kimdubi</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#mysql-replication_do_db-%ec%82%ac%ec%9a%a9%ec%8b%9c-%ec%a3%bc%ec%9d%98%ec%82%ac%ed%95%ad aria-label="MySQL replication_do_db 사용시 주의사항">MySQL replication_do_db 사용시 주의사항</a></li><li><a href=#replication-filter%ea%b0%9c%ec%9a%94 aria-label="Replication filter 개요">Replication filter 개요</a></li><li><a href=#replicate_do_db aria-label=REPLICATE_DO_DB>REPLICATE_DO_DB</a><ul><li><a href=#%ec%b0%b8%ea%b3%a0%eb%a7%81%ed%81%ac aria-label=참고링크>참고링크</a></li><li><a href=#%ec%a3%bc%ec%9d%98%ec%82%ac%ed%95%ad aria-label=주의사항>주의사항</a></li><li><a href=#binlog_format-%ea%b0%9c%ec%9a%94 aria-label="binlog_format 개요">binlog_format 개요</a></li></ul></li><li><a href=#%ed%95%b4%ea%b2%b0%eb%b0%a9%ec%95%88 aria-label=해결방안>해결방안</a></li></ul></div></details></div><div class=post-content><h2 id=mysql-replication_do_db-사용시-주의사항>MySQL replication_do_db 사용시 주의사항<a hidden class=anchor aria-hidden=true href=#mysql-replication_do_db-사용시-주의사항>#</a></h2><p>하나의 DB서버에 여러 논리DB들이 있고 그 중 특정 논리DB를 다른 DB서버로 분리하는 작업을 종종 합니다.<br>이때 무중단으로 분리하기 위해서 replication filter 기능을 사용하는데요<br>이 때의 주의사항을 알아보도록 하겠습니다.</p><h2 id=replication-filter개요>Replication filter 개요<a hidden class=anchor aria-hidden=true href=#replication-filter개요>#</a></h2><ul><li>리플리케이션 필터는 MySQL 복제 구성 시에 DB인스턴스 전체를 복제하는 것이 아닌 특정 논리DB만 복제해야할 때 사용할 수 있는 기능</li><li>옵션의 종류는 아래와 같이 존재<ul><li>REPLICATE_DO_DB – 특정디비만</li><li>REPLICATE_IGNORE_DB  – 특정디비제외</li><li>REPLICATE_DO_TABLE  – 특정테이블만</li><li>REPLICATE_IGNORE_TABLE  – 특정테이블 제외</li><li>REPLICATE_WILD_DO_TABLE  – 특정패턴테이블만</li><li>REPLICATE_WILD_IGNORE_TABLE  – 특정패턴테이블 제외</li><li>REPLICATE_REWRITE_DB  – DB명 바꿔서</li></ul></li><li>CHANGE REPLICATION FILTER 구문 사용시 동일종류 필터는 마지막 수행된 쿼리만 사용됨 ex)</li></ul><pre><code>change replication filter replicate_do_db=(kimdubi_db),replicate_do_db=(kimdubi_db2,kimdubi_db3);
</code></pre><p>=> kimdubi_db2, kimdubi_db3 만 replication 하도록 반영됨</p><h2 id=replicate_do_db>REPLICATE_DO_DB<a hidden class=anchor aria-hidden=true href=#replicate_do_db>#</a></h2><h3 id=참고링크>참고링크<a hidden class=anchor aria-hidden=true href=#참고링크>#</a></h3><ul><li><a href=https://dev.mysql.com/doc/refman/5.7/en/change-replication-filter.html></a><a href=https://dev.mysql.com/doc/refman/5.7/en/change-replication-filter.html>https://dev.mysql.com/doc/refman/5.7/en/change-replication-filter.html</a></li><li><a href=https://dev.mysql.com/doc/refman/5.7/en/replication-options-replica.html#option_mysqld_replicate-do-db></a><a href=https://dev.mysql.com/doc/refman/5.7/en/replication-options-replica.html#option>https://dev.mysql.com/doc/refman/5.7/en/replication-options-replica.html#option</a>_mysqld_replicate-do-db</li></ul><h3 id=주의사항>주의사항<a hidden class=anchor aria-hidden=true href=#주의사항>#</a></h3><ul><li>binlog_format=statement / mixed 일때 cross database query 복제안됨</li><li>default database 를 선언하지 않고 db명.테이블명 형태로 쿼리하는 경우도 복제 안됨</li></ul><pre><code>--replicate-do-db=sales

USE prices;
UPDATE sales.january SET amount=amount+1000;
</code></pre><p>=> prices DB에 접속 후 sales.테이블을 찾는 경우 Slave에 반영 안됨<br>default database 를 선언하지 않고 db명.테이블명 형태로 쿼리하는 경우도 복제 안됨</p><ul><li>user 생성 복제 실패</li></ul><pre><code>### SLAVE 복제 정보 
replication_do_db=kimdubi_db,mysql,information_schema

mysql&gt; show slave status\G;
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event

              Master_Log_File: mysql-bin.000162
          Read_Master_Log_Pos: 484079558
               Relay_Log_File: relay-bin.000005
                Relay_Log_Pos: 892
        Relay_Master_Log_File: mysql-bin.000162

             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB: kimdubi_db,mysql,information_schema


### Master user 생성
mysql&gt; create user 'test2'@'%' identified with mysql_native_password by 'test123';
Query OK, 0 rows affected (0.00 sec)

### Slave user 조회
mysql&gt; select user,host from mysql.user where user='test2';
Empty set (0.00 sec)
</code></pre><ul><li>filter 외 다른 DB에서 수행한 DDL에 의해 복제 깨지는 케이스</li></ul><pre><code># replication filter 적용된 DB에서 다른 논리DB의 오브젝트에 DDL을 수행하는경우

### master

mysql&gt; create table testdb2.tb_filter  (a int auto_increment, b varchar(10), c datetime, primary key (a));
Query OK, 0 rows affected (0.09 sec)

mysql&gt; use testdb2;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; drop table testdb2.tb_filter;
Query OK, 0 rows affected (0.23 sec)

### SLAVE 복제 깨짐

mysql&gt; show slave status\G;
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event

              Master_Log_File: mysql-bin.000162
          Read_Master_Log_Pos: 484079558
               Relay_Log_File: relay-bin.000005
                Relay_Log_Pos: 892
        Relay_Master_Log_File: mysql-bin.000162

             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB: kimdubi_db,mysql,information_schema

                   Last_Errno: 1051
                   Last_Error: Error 'Unknown table 'testdb2.tb_filter'' on query. Default database: 'kimdubi_db'. Query: 'DROP TABLE `testdb2`.`tb_filter` /* generated by server */'
                 Skip_Counter: 0
</code></pre><h3 id=binlog_format-개요>binlog_format 개요<a hidden class=anchor aria-hidden=true href=#binlog_format-개요>#</a></h3><ul><li>참고링크 : <a href=https://dev.mysql.com/doc/refman/5.7/en/binary-log-setting.html></a><a href=https://dev.mysql.com/doc/refman/5.7/en/binary-log-setting.html>https://dev.mysql.com/doc/refman/5.7/en/binary-log-setting.html</a></li><li>종류<ul><li>statement / 데이터 변경에 사용된 쿼리를 그대로 슬레이브에 전달하는 형태</li><li>row / 데이터 변경이 일어난 row의 정보를 어플리케이션에서 인지하는 포멧으로 슬레이브에 전달하는 형태</li><li>mixed / 위 두 방식을 혼합한 방식으로 대부분 statement로 진행하고, 일부 row방식으로 동작<ul><li>(limit, now() 등 수행하는 서버,시점에 따라 결과 값이 달라질 수 있는 쿼리들에 대해선 row로 동작)</li></ul></li></ul></li><li>특징<ul><li>동적으로 변경가능</li><li>global / session  변경 가능</li><li>쿼리 수행에는 영향이 없고 복제에만 영향 줌</li></ul></li></ul><h2 id=해결방안>해결방안<a hidden class=anchor aria-hidden=true href=#해결방안>#</a></h2><ul><li>binlog_format 을 ROW로 사용한다<ul><li>이 방법은 DB서버를 재기동해야 하기 때문에 개발팀과의 협의가 필요함 (set session binlog_format=row 로는 한계가 있음)</li><li>binlog 저장량이 급증하는 이슈가 있음</li></ul></li><li>어플리케이션의 JDBC 설정에 접근하는 논리DB에 대한 설정이 정확히 설정됐는지 확인</li><li>서로 다른 논리DB 간 cross database query 가 없는지 확인할 것</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/mysql/>mysql</a></li><li><a href=/tags/replication/>replication</a></li><li><a href=/tags/%EC%9A%B4%EC%98%81/>운영</a></li></ul><nav class=paginav><a class=prev href=/mysql/mysqlshell_parallel_dump/><span class=title>« Prev Page</span><br><span>MySQL Shell parallel dump&load</span></a>
<a class=next href=/mysql/transacion_isolation/><span class=title>Next Page »</span><br><span>MySQL의 Transacion isolation 간단히 살펴보기</span></a></nav></footer><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='kimdubia';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2021 <a href>kimDuBiA</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu')
menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerText='copy';function copyingDone(){copybutton.innerText='copied!';setTimeout(()=>{copybutton.innerText='copy';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>