<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ansible로 MySQL 관리하기 | kimDuBiA</title><meta name=keywords content="ansible,mysql"><meta name=description content="ansible 설치 [root@test_ansible]# git clone https://github.com/ansible/ansible.git [root@test_ansible]# make [root@test_ansible]# make install   make error 발생 시  Traceback (most recent call last): File &#34;packaging/release/versionhelper/version_helper.py&#34;, line 9, in <module> from packaging.version import Version, VERSION_PATTERN ImportError: No module named packaging.version Makefile:40: *** &#34;version_helper failed&#34;. Stop. [root@test_ansible]# pip install --upgrade setuptools [root@test_ansible]# pip install packaging => 설치 후 make 재시도
 ansible configure 파일 설정  $ vi ~/.bash_profile ansible 사용 계정 profile에 아래 환경변수 설정 시 ansible command 수행할 때 아래의 ansible."><meta name=author content="kimdubi"><link rel=canonical href=/etc/ansible_mysql_query/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.2dbef8664bbfb3e83a0a44fd4a8fc5010240dbcd1dbc1400753b928b497b8f5e.css integrity="sha256-Lb74Zku/s+g6CkT9So/FAQJA280dvBQAdTuSi0l7j14=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-123-45','auto');ga('send','pageview');}</script><meta property="og:title" content="Ansible로 MySQL 관리하기"><meta property="og:description" content="ansible 설치 [root@test_ansible]# git clone https://github.com/ansible/ansible.git [root@test_ansible]# make [root@test_ansible]# make install   make error 발생 시  Traceback (most recent call last): File &#34;packaging/release/versionhelper/version_helper.py&#34;, line 9, in <module> from packaging.version import Version, VERSION_PATTERN ImportError: No module named packaging.version Makefile:40: *** &#34;version_helper failed&#34;. Stop. [root@test_ansible]# pip install --upgrade setuptools [root@test_ansible]# pip install packaging => 설치 후 make 재시도
 ansible configure 파일 설정  $ vi ~/.bash_profile ansible 사용 계정 profile에 아래 환경변수 설정 시 ansible command 수행할 때 아래의 ansible."><meta property="og:type" content="article"><meta property="og:url" content="/etc/ansible_mysql_query/"><meta property="og:image" content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="etc"><meta property="article:published_time" content="2021-10-06T21:40:19+09:00"><meta property="article:modified_time" content="2021-10-06T21:40:19+09:00"><meta property="og:site_name" content="kimDuBiA"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Ansible로 MySQL 관리하기"><meta name=twitter:description content="ansible 설치 [root@test_ansible]# git clone https://github.com/ansible/ansible.git [root@test_ansible]# make [root@test_ansible]# make install   make error 발생 시  Traceback (most recent call last): File &#34;packaging/release/versionhelper/version_helper.py&#34;, line 9, in <module> from packaging.version import Version, VERSION_PATTERN ImportError: No module named packaging.version Makefile:40: *** &#34;version_helper failed&#34;. Stop. [root@test_ansible]# pip install --upgrade setuptools [root@test_ansible]# pip install packaging => 설치 후 make 재시도
 ansible configure 파일 설정  $ vi ~/.bash_profile ansible 사용 계정 profile에 아래 환경변수 설정 시 ansible command 수행할 때 아래의 ansible."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Etcs","item":"/etc/"},{"@type":"ListItem","position":3,"name":"Ansible로 MySQL 관리하기","item":"/etc/ansible_mysql_query/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Ansible로 MySQL 관리하기","name":"Ansible로 MySQL 관리하기","description":"ansible 설치 [root@test_ansible]# git clone https://github.com/ansible/ansible.git [root@test_ansible]# make [root@test_ansible]# make install   make error 발생 시  Traceback (most recent call last): File \u0026quot;packaging/release/versionhelper/version_helper.py\u0026quot;, line 9, in \u0026lt;module\u0026gt; from packaging.version import Version, VERSION_PATTERN ImportError: No module named packaging.version Makefile:40: *** \u0026quot;version_helper failed\u0026quot;. Stop. [root@test_ansible]# pip install --upgrade setuptools [root@test_ansible]# pip install packaging =\u0026gt; 설치 후 make 재시도\n ansible configure 파일 설정  $ vi ~/.bash_profile ansible 사용 계정 profile에 아래 환경변수 설정 시 ansible command 수행할 때 아래의 ansible.","keywords":["ansible","mysql"],"articleBody":" ansible 설치 [root@test_ansible]# git clone https://github.com/ansible/ansible.git [root@test_ansible]# make [root@test_ansible]# make install   make error 발생 시  Traceback (most recent call last): File \"packaging/release/versionhelper/version_helper.py\", line 9, in  from packaging.version import Version, VERSION_PATTERN ImportError: No module named packaging.version Makefile:40: *** \"version_helper failed\". Stop. [root@test_ansible]# pip install --upgrade setuptools [root@test_ansible]# pip install packaging = 설치 후 make 재시도\n ansible configure 파일 설정  $ vi ~/.bash_profile ansible 사용 계정 profile에 아래 환경변수 설정 시 ansible command 수행할 때 아래의 ansible.cfg 설정파일을 자동으로 읽어옴 $ export ANSIBLE_CONFIG=/engn001/ansible/work/ansible.cfg $ export ANSIBLE_HOSTS=/engn001/ansible/work/hosts $ vi ansible.cfg forks = 10 ### multi thread 개수 host_key_checking = False ### 호스트 키 확인과정이 필요한지 timeout = 5 remote_user = ansible_user ### target 서버에 붙을 계정 ansible 구성요소 inventory $ vi /engn001/ansible/work/hosts [mysql_test] 11.11.111.11 22.222.222.22 333.333.333.33 444.444.444.555 [mysql_test:vars] ansible_ssh_user=root port=3306 centos_version:6 [mysql_prod] 11.11.111.111 22.222.222.222 333.333.333.333 444.444.444.5555 [mysql_prod:vars] ansible_ssh_user=root port=13306 centos_version:7 [redis] redis1 redis2 redis3   ansible 로 접속해서 작업할 target 서버 리스트 all 로 모든 대상서버에 command를 수행하거나 [그룹명] 로 그룹핑한 서버들에만 선별적으로 command 수행 가능 /etc/hosts 에 대상 서버 ip에 alias를 주면 inventory 파일에서 alias 로 지정 가능 대상서버들은 ansible 서버와 ssh keygen 을 통해 key 작업을 해주어야함 위에서 설정한 vars 값은 playbook 에서 {{port}} , {{centos_version}} 등으로 사용 가능  module $ ansible-doc -l | grep mysql_ mysql_info Gather information about MySQL servers mysql_db Add or remove MySQL databases from a remote host mysql_variables Manage MySQL global variables mysql_user Adds or removes a user from a MySQL database mysql_replication Manage MySQL replication  = task를 어떻게 수행할 것인지 정의해둔 command의 집합\n 각 module 사용법은 공홈 매뉴얼에서 확인 가능 https://docs.ansible.com/ansible/latest/modules/mysql_variables_module.html  playbook * vi /engn001/ansible/work/playbook_mysql_task1.yaml --- - hosts: mysql_prod become_user: testuser tasks: - name: source profile shell: source ~/.bash_profile \u0026\u0026 echo $MARIA_HOME args: chdir: /home/testuser/ executable: /bin/bash register: maria_home - name: mysql command command: mysql -utestuser -ptest123 -S \"{{ item }}\"/mysql/mysql.sock -e \"show processlist\\G\" when : item is defined with_items: - \"{{ maria_home.stdout }}\" register: result - debug: msg=\"{{ result.results | json_query('[].stdout_lines[]') }}\"    yaml 형식\n  위와 같이 playbook 을 사용하여 특정 서버들에서 수행할 task들을 설정할 수 있음\n  위 예시는 inventory 설정의 대상서버들 중 [mysql_prod] 그룹을 대상으로 하고\n  source profile , mysql_command 을 포함하는 task (ansible module를 호출하는 단위)를 수행함\n  위 playbook 설명\n  source profile : ansible이 대상 서버에 ssh 수행하는 방식은 interactive 하기 때문에 login shell 이 수행 되지 않아 대상 서버 계정의 profile 설정을 사용하려면 위와 같이 설정이 필요함 mysql command: profile 을 읽어 maria db의 home 을 maria_home 변수로 register 후 'mysql command' 수행하는데 활용함 그 결과를 register 에 담아서 debug:msg 에서 출력함 ansible-playbook 수행 결과 $ ansible-playbook -i [인벤토리파일] [플레이북명] PLAY [dbservers_test_user01] ******************************************************* TASK [Gathering Facts] ********************************************************* ok: [11.111.111.111] ok: [22.222.222.222] TASK [source profile] ********************************************************** changed: [22.222.222.222] changed: [11.111.111.111] TASK [mysql command] *********************************************************** changed: [22.222.222.222] = (item=/engn001/test_user01/TEST_10.2.4) changed: [11.111.111.111] = (item=/engn001/test_user01/TEST_10.2.4) TASK [debug] ******************************************************************* ok: [11.111.111.111] = { \"msg\": [ \"*************************** 1. row ***************************\", \" Id: 1\", \" User: system user\", \" Host: \", \" db: NULL\", \" Command: Daemon\", \" Time: NULL\", \" State: InnoDB background thread\", \" Info: NULL\", \"Progress: 0.000\", \"*************************** 2. row ***************************\", \" Id: 2\", \" User: system user\", \" Host: \", \" db: NULL\", \" Command: Daemon\", \" Time: NULL\", \" State: InnoDB background thread\", \" Info: NULL\", \"Progress: 0.000\", ] } ok: [22.222.222.222] = { \"msg\": [ \"*************************** 1. row ***************************\", \" Id: 1\", \" User: system user\", \" Host: \", \" db: NULL\", \" Command: Daemon\", \" Time: NULL\", \" State: InnoDB background thread\", \" Info: NULL\", \"Progress: 0.000\", \"*************************** 2. row ***************************\", \" Id: 2\", \" User: system user\", \" Host: \", \" db: NULL\", \" Command: Daemon\", \" Time: NULL\", \" State: InnoDB background thread\", \" Info: NULL\", \"Progress: 0.000\", ] } PLAY RECAP ********************************************************************* 11.111.111.111 : ok=4 changed=2 unreachable=0 failed=0 skipped=0 22.222.222.222 : ok=4 changed=2 unreachable=0 failed=0 skipped=0   ok : 변경사항 없음 changed : 변경사항 있음 unreachable : 서버에 접속 실패 failed : 실패 skipped : playbook 설정의 조건에 맞지 않아서 실행되지 않은 경우  MySQL module 활용 예제  variables 조회  --- - name: test hosts: mysql gather_facts: no vars: mysql_user: prom mysql_password: qhdks123 mysql_port: 3306 login_unix_socket: /engn001/mysql/data/mysql.sock tasks: - name: install mysql-python yum: name: \"{{ item }}\" state: installed with_items: - MySQL-python - name: get variables mysql_variables: login_user: \"{{ mysql_user }}\" login_password: \"{{ mysql_password }}\" variable: sql_mode register: result - debug: var=result  결과  ok: [172.18.0.3] = { \"result\": { \"changed\": false, \"failed\": false, \"msg\": \"ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION\" } } ok: [172.18.0.2] = { \"result\": { \"changed\": false, \"failed\": false, \"msg\": \"ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION\" } } ","wordCount":"730","inLanguage":"en","datePublished":"2021-10-06T21:40:19+09:00","dateModified":"2021-10-06T21:40:19+09:00","author":{"@type":"Person","name":"kimdubi"},"mainEntityOfPage":{"@type":"WebPage","@id":"/etc/ansible_mysql_query/"},"publisher":{"@type":"Organization","name":"kimDuBiA","logo":{"@type":"ImageObject","url":"%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=/categories/ title=categories><span>categories</span></a></li><li><a href=/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href>Home</a>&nbsp;»&nbsp;<a href=/etc/>Etcs</a></div><h1 class=post-title>Ansible로 MySQL 관리하기</h1><div class=post-meta>October 6, 2021&nbsp;·&nbsp;4 min&nbsp;·&nbsp;kimdubi</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#ansible-%ec%84%a4%ec%b9%98 aria-label="ansible 설치">ansible 설치</a></li><li><a href=#ansible-%ea%b5%ac%ec%84%b1%ec%9a%94%ec%86%8c aria-label="ansible 구성요소">ansible 구성요소</a><ul><li><a href=#inventory aria-label=inventory>inventory</a></li><li><a href=#module aria-label=module>module</a></li><li><a href=#playbook aria-label=playbook>playbook</a></li><li><a href=#ansible-playbook-%ec%88%98%ed%96%89-%ea%b2%b0%ea%b3%bc aria-label="ansible-playbook 수행 결과">ansible-playbook 수행 결과</a></li><li><a href=#mysql-module-%ed%99%9c%ec%9a%a9-%ec%98%88%ec%a0%9c aria-label="MySQL module 활용 예제">MySQL module 활용 예제</a></li></ul></li></ul></div></details></div><div class=post-content><hr><h3 id=ansible-설치>ansible 설치<a hidden class=anchor aria-hidden=true href=#ansible-설치>#</a></h3><pre><code>[root@test_ansible]# git clone https://github.com/ansible/ansible.git

[root@test_ansible]# make
[root@test_ansible]# make install
</code></pre><ul><li>make error 발생 시</li></ul><pre><code>Traceback (most recent call last):
  File &quot;packaging/release/versionhelper/version_helper.py&quot;, line 9, in &lt;module&gt;
    from packaging.version import Version, VERSION_PATTERN
ImportError: No module named packaging.version
Makefile:40: *** &quot;version_helper failed&quot;.  Stop.

[root@test_ansible]# pip install --upgrade setuptools
[root@test_ansible]# pip install packaging
</code></pre><p>=> 설치 후 make 재시도</p><ul><li>ansible configure 파일 설정</li></ul><pre><code>$ vi ~/.bash_profile
    
ansible 사용 계정 profile에 아래 환경변수 설정 시 ansible command 수행할 때 아래의 ansible.cfg 설정파일을 자동으로 읽어옴
    
$ export ANSIBLE_CONFIG=/engn001/ansible/work/ansible.cfg
$ export ANSIBLE_HOSTS=/engn001/ansible/work/hosts 
    
$ vi ansible.cfg
    
forks          = 10   ### multi thread 개수 
host_key_checking = False   ### 호스트 키 확인과정이 필요한지
timeout = 5
remote_user = ansible_user   ### target 서버에 붙을 계정
</code></pre><h3 id=ansible-구성요소>ansible 구성요소<a hidden class=anchor aria-hidden=true href=#ansible-구성요소>#</a></h3><h4 id=inventory>inventory<a hidden class=anchor aria-hidden=true href=#inventory>#</a></h4><pre><code>$ vi /engn001/ansible/work/hosts 

[mysql_test]

11.11.111.11
22.222.222.22
333.333.333.33
444.444.444.555

[mysql_test:vars]
ansible_ssh_user=root
port=3306
centos_version:6

[mysql_prod]

11.11.111.111
22.222.222.222
333.333.333.333
444.444.444.5555

[mysql_prod:vars]
ansible_ssh_user=root
port=13306
centos_version:7

[redis]

redis1
redis2
redis3
</code></pre><ul><li>ansible 로 접속해서 작업할 target 서버 리스트</li><li>all 로 모든 대상서버에 command를 수행하거나 [그룹명] 로 그룹핑한 서버들에만 선별적으로 command 수행 가능</li><li>/etc/hosts 에 대상 서버 ip에 alias를 주면 inventory 파일에서 alias 로 지정 가능</li><li>대상서버들은 ansible 서버와 ssh keygen 을 통해 key 작업을 해주어야함</li><li>위에서 설정한 vars 값은 playbook 에서 {{port}} , {{centos_version}} 등으로 사용 가능</li></ul><h4 id=module>module<a hidden class=anchor aria-hidden=true href=#module>#</a></h4><pre><code>$ ansible-doc -l | grep mysql_
mysql_info                           Gather information about MySQL servers
mysql_db                             Add or remove MySQL databases from a remote host
mysql_variables                      Manage MySQL global variables
mysql_user                           Adds or removes a user from a MySQL database
mysql_replication                    Manage MySQL replication
</code></pre><p>=> task를 어떻게 수행할 것인지 정의해둔 command의 집합</p><ul><li>각 module 사용법은 공홈 매뉴얼에서 확인 가능 <a href=https://docs.ansible.com/ansible/latest/modules/mysql_variables_module.html>https://docs.ansible.com/ansible/latest/modules/mysql_variables_module.html</a></li></ul><h4 id=playbook>playbook<a hidden class=anchor aria-hidden=true href=#playbook>#</a></h4><pre><code>* vi /engn001/ansible/work/playbook_mysql_task1.yaml

---
- hosts: mysql_prod
  become_user: testuser
  tasks:
  - name: source profile
    shell: source ~/.bash_profile &amp;&amp; echo $MARIA_HOME
    args:
      chdir: /home/testuser/
      executable: /bin/bash
    register: maria_home
  - name: mysql command
    command: mysql -utestuser -ptest123 -S &quot;{{ item }}&quot;/mysql/mysql.sock -e &quot;show processlist\G&quot;
    when : item is defined
    with_items:
    - &quot;{{ maria_home.stdout }}&quot;
    register: result
  - debug:
      msg=&quot;{{ result.results | json_query('[].stdout_lines[]') }}&quot;
</code></pre><ul><li><p>yaml 형식</p></li><li><p>위와 같이 playbook 을 사용하여 특정 서버들에서 수행할 task들을 설정할 수 있음</p></li><li><p>위 예시는 inventory 설정의 대상서버들 중 [mysql_prod] 그룹을 대상으로 하고</p></li><li><p>source profile , mysql_command 을 포함하는 task (ansible module를 호출하는 단위)를 수행함</p></li><li><p>위 playbook 설명</p></li></ul><pre><code>source profile :
ansible이 대상 서버에 ssh 수행하는 방식은 interactive 하기 때문에 login shell 이 수행 되지 않아 대상 서버 계정의 profile 설정을 사용하려면 위와 같이 설정이 필요함
 
mysql command:
profile 을 읽어 maria db의 home 을 maria_home 변수로 register 후 'mysql command' 수행하는데 활용함
그 결과를 register 에 담아서 debug:msg 에서 출력함
</code></pre><h4 id=ansible-playbook-수행-결과>ansible-playbook 수행 결과<a hidden class=anchor aria-hidden=true href=#ansible-playbook-수행-결과>#</a></h4><pre><code>$ ansible-playbook -i [인벤토리파일]  [플레이북명]

PLAY [dbservers_test_user01] *******************************************************
TASK [Gathering Facts] *********************************************************
ok: [11.111.111.111]
ok: [22.222.222.222]

TASK [source profile] **********************************************************
changed: [22.222.222.222]
changed: [11.111.111.111]

TASK [mysql command] ***********************************************************
changed: [22.222.222.222] =&gt; (item=/engn001/test_user01/TEST_10.2.4)
changed: [11.111.111.111] =&gt; (item=/engn001/test_user01/TEST_10.2.4)

TASK [debug] *******************************************************************
ok: [11.111.111.111] =&gt; {
    &quot;msg&quot;: [
        &quot;*************************** 1. row ***************************&quot;,
        &quot;      Id: 1&quot;,
        &quot;    User: system user&quot;,
        &quot;    Host: &quot;,
        &quot;      db: NULL&quot;,
        &quot; Command: Daemon&quot;,
        &quot;    Time: NULL&quot;,
        &quot;   State: InnoDB background thread&quot;,
        &quot;    Info: NULL&quot;,
        &quot;Progress: 0.000&quot;,
        &quot;*************************** 2. row ***************************&quot;,
        &quot;      Id: 2&quot;,
        &quot;    User: system user&quot;,
        &quot;    Host: &quot;,
        &quot;      db: NULL&quot;,
        &quot; Command: Daemon&quot;,
        &quot;    Time: NULL&quot;,
        &quot;   State: InnoDB background thread&quot;,
        &quot;    Info: NULL&quot;,
        &quot;Progress: 0.000&quot;,

    ]
}
ok: [22.222.222.222] =&gt; {
    &quot;msg&quot;: [
        &quot;*************************** 1. row ***************************&quot;,
        &quot;      Id: 1&quot;,
        &quot;    User: system user&quot;,
        &quot;    Host: &quot;,
        &quot;      db: NULL&quot;,
        &quot; Command: Daemon&quot;,
        &quot;    Time: NULL&quot;,
        &quot;   State: InnoDB background thread&quot;,
        &quot;    Info: NULL&quot;,
        &quot;Progress: 0.000&quot;,

        &quot;*************************** 2. row ***************************&quot;,
        &quot;      Id: 2&quot;,
        &quot;    User: system user&quot;,
        &quot;    Host: &quot;,
        &quot;      db: NULL&quot;,
        &quot; Command: Daemon&quot;,
        &quot;    Time: NULL&quot;,
        &quot;   State: InnoDB background thread&quot;,
        &quot;    Info: NULL&quot;,
        &quot;Progress: 0.000&quot;,

    ]

}

PLAY RECAP *********************************************************************

11.111.111.111              : ok=4    changed=2    unreachable=0    failed=0    skipped=0

22.222.222.222             : ok=4    changed=2    unreachable=0    failed=0    skipped=0
</code></pre><ul><li>ok : 변경사항 없음</li><li>changed : 변경사항 있음</li><li>unreachable : 서버에 접속 실패</li><li>failed : 실패</li><li>skipped : playbook 설정의 조건에 맞지 않아서 실행되지 않은 경우</li></ul><h4 id=mysql-module-활용-예제>MySQL module 활용 예제<a hidden class=anchor aria-hidden=true href=#mysql-module-활용-예제>#</a></h4><ul><li>variables 조회</li></ul><pre><code>---
- name: test
  hosts: mysql
  gather_facts: no
  vars:
    mysql_user: prom
    mysql_password: qhdks123
    mysql_port: 3306
    login_unix_socket: /engn001/mysql/data/mysql.sock
  tasks:
  - name: install mysql-python
    yum:
      name: &quot;{{ item }}&quot;
      state: installed
    with_items:
      - MySQL-python
  - name: get variables
    mysql_variables:
      login_user: &quot;{{ mysql_user }}&quot;
      login_password: &quot;{{ mysql_password }}&quot;
      variable: sql_mode
    register: result
  - debug: var=result
</code></pre><ul><li>결과</li></ul><pre><code>ok: [172.18.0.3] =&gt; {
    &quot;result&quot;: {
        &quot;changed&quot;: false,
        &quot;failed&quot;: false,
        &quot;msg&quot;: &quot;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION&quot;
    }
}
ok: [172.18.0.2] =&gt; {
    &quot;result&quot;: {
        &quot;changed&quot;: false,
        &quot;failed&quot;: false,
        &quot;msg&quot;: &quot;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION&quot;
    }
}
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=/tags/ansible/>ansible</a></li><li><a href=/tags/mysql/>mysql</a></li></ul></footer><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='disqus_nLxot7hRj6';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2021 <a href>kimDuBiA</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu')
menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerText='copy';function copyingDone(){copybutton.innerText='copied!';setTimeout(()=>{copybutton.innerText='copy';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>